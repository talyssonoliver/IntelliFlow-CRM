=== IntelliFlow CRM - Supabase Migration Test ===
Timestamp: 2025-12-14T23:35:00+00:00
Environment: development + test

--- Test 1: PostgreSQL Version ---
Database: intelliflow-postgres (port 5432)
Version: PostgreSQL 16.11 (Debian 16.11-1.pgdg12+1)
Result: PASS

--- Test 2: pgvector Extension ---
Extension: vector
Status: Installed and active
Test: '[1,2,3]'::vector(3) <=> '[4,5,6]'::vector(3) = 0.0254
Result: PASS

--- Test 3: Schema Tables ---
Tables created:
  1. users
  2. leads (with embedding vector(1536))
  3. contacts (with embedding vector(1536))
  4. accounts
  5. opportunities
  6. tasks
  7. ai_scores
  8. audit_logs
  9. domain_events
Total: 9 tables
Result: PASS

--- Test 4: Foreign Keys ---
Constraints verified:
  - leads_ownerId_fkey -> users.id
  - contacts_ownerId_fkey -> users.id
  - contacts_accountId_fkey -> accounts.id
  - accounts_ownerId_fkey -> users.id
  - opportunities_ownerId_fkey -> users.id
  - opportunities_accountId_fkey -> accounts.id
  - tasks_ownerId_fkey -> users.id
  - ai_scores_leadId_fkey -> leads.id
  - ai_scores_scoredById_fkey -> users.id
  - audit_logs_userId_fkey -> users.id
Total: 15 constraints
Result: PASS

--- Test 5: Vector Search Functions ---
Functions created:
  - search_leads_by_embedding(vector(1536), float, int)
  - search_contacts_by_embedding(vector(1536), float, int)
Result: PASS

--- Test 6: Test Database ---
Database: intelliflow-postgres-test (port 5433)
Status: Migration applied successfully
Tables: 9
Result: PASS

=== All Tests Completed ===
Total: 6 | Passed: 6 | Failed: 0
