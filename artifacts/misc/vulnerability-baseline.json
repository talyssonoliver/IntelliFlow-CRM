{
  "$schema": "../../apps/project-tracker/docs/metrics/schemas/vulnerability-baseline.schema.json",
  "version": "1.2.0",
  "generated_at": "2026-01-22T12:00:00Z",
  "scan_tools": [
    {
      "name": "pnpm audit",
      "version": "9.x",
      "last_run": "2026-01-22T12:00:00Z"
    },
    {
      "name": "snyk",
      "version": "1.x",
      "last_run": "2025-12-29T21:00:00Z",
      "notes": "CI-only, not run locally"
    },
    {
      "name": "trivy",
      "version": "0.x",
      "last_run": "2025-12-29T21:00:00Z",
      "notes": "CI-only, not run locally"
    },
    {
      "name": "osv-scanner",
      "version": "1.x",
      "last_run": "2025-12-29T21:00:00Z",
      "notes": "CI-only, not run locally"
    }
  ],
  "summary": {
    "total_dependencies": 847,
    "direct_dependencies": 156,
    "transitive_dependencies": 691,
    "vulnerabilities": {
      "critical": 0,
      "high": 0,
      "moderate": 0,
      "low": 0,
      "total": 0
    },
    "kpi_status": {
      "zero_critical": true,
      "zero_high": true,
      "zero_moderate": true,
      "zero_low": true,
      "baseline_documented": true
    }
  },
  "vulnerabilities": [],
  "waivers": [],
  "accepted_risks": [],
  "remediation_applied": {
    "date": "2026-01-22T12:00:00Z",
    "method": "pnpm overrides in package.json",
    "vulnerabilities_fixed": [
      {
        "id": "GHSA-67mh-4wv8-2f99",
        "module": "esbuild",
        "severity": "moderate",
        "fix_applied": "Override to >=0.25.0"
      },
      {
        "id": "GHSA-xxjr-mmjv-4gpg",
        "cve": "CVE-2025-13465",
        "module": "lodash-es",
        "severity": "moderate",
        "fix_applied": "Override to >=4.17.23"
      },
      {
        "id": "GHSA-xxjr-mmjv-4gpg",
        "cve": "CVE-2025-13465",
        "module": "lodash",
        "severity": "moderate",
        "fix_applied": "Override to >=4.17.23"
      },
      {
        "id": "GHSA-73rr-hh4g-fpgx",
        "module": "diff",
        "severity": "low",
        "fix_applied": "Override to >=4.0.4"
      }
    ],
    "package_json_changes": {
      "file": "package.json",
      "section_added": "pnpm.overrides",
      "overrides": {
        "lodash": ">=4.17.23",
        "lodash-es": ">=4.17.23",
        "diff": ">=4.0.4",
        "esbuild": ">=0.25.0"
      }
    }
  },
  "scan_results": {
    "pnpm_audit": {
      "status": "pass",
      "exit_code": 0,
      "vulnerabilities_count": 0,
      "result": "No known vulnerabilities found",
      "metadata": {
        "dependencies": 847,
        "devDependencies": 412,
        "totalDependencies": 1259
      }
    },
    "snyk": {
      "status": "not_run_locally",
      "notes": "Available in CI pipeline only"
    },
    "trivy": {
      "status": "not_run_locally",
      "notes": "Available in CI pipeline only"
    },
    "osv_scanner": {
      "status": "not_run_locally",
      "notes": "Available in CI pipeline only"
    }
  },
  "compliance": {
    "sla_compliance": {
      "critical_within_24h": true,
      "high_within_7d": true,
      "medium_within_30d": true,
      "low_within_90d": true
    },
    "kpi_targets_met": {
      "zero_critical": true,
      "zero_high": true,
      "zero_moderate": true,
      "zero_low": true
    },
    "last_audit": "2026-01-22T12:00:00Z",
    "next_audit": "2026-01-29T12:00:00Z"
  },
  "metrics": {
    "mean_time_to_detect_hours": null,
    "mean_time_to_remediate_hours": 0.5,
    "vulnerabilities_this_month": 4,
    "vulnerabilities_remediated_this_month": 4,
    "waiver_count": 0
  },
  "history": [
    {
      "date": "2025-12-29T21:00:00Z",
      "vulnerabilities": 0,
      "notes": "Initial baseline established"
    },
    {
      "date": "2026-01-05T12:00:00Z",
      "vulnerabilities": 3,
      "notes": "nodemailer vulnerabilities identified"
    },
    {
      "date": "2026-01-22T11:30:00Z",
      "vulnerabilities": 4,
      "notes": "Updated scan: lodash, lodash-es, esbuild, diff vulnerabilities (all dev deps)"
    },
    {
      "date": "2026-01-22T12:00:00Z",
      "vulnerabilities": 0,
      "notes": "ALL VULNERABILITIES FIXED via pnpm overrides"
    }
  ],
  "notes": [
    "Initial baseline established on 2025-12-29",
    "All vulnerabilities have been REMEDIATED as of 2026-01-22",
    "Fix applied via pnpm.overrides in package.json",
    "Weekly scans scheduled via GitHub Actions",
    "ALL KPI targets are MET (zero vulnerabilities)"
  ]
}
