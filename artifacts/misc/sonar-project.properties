# =============================================================================
# IntelliFlow CRM - SonarQube Project Configuration (Artifact Reference)
# =============================================================================
# This artifact documents the SonarQube configuration for IFC-111.
# The canonical configuration file is at the repo root: /sonar-project.properties
#
# Task: IFC-111 - Set up SonarQube and integrate static analysis into CI/CD
# Owner: DevOps + QA Lead (STOA-Quality)
# Sprint: 5
# KPIs: Sonar quality gate >= A, zero blocker issues
# =============================================================================

# -----------------------------------------------------------------------------
# Project Identification
# -----------------------------------------------------------------------------
sonar.projectKey=IntelliFlow
sonar.projectName=IntelliFlow CRM
sonar.projectVersion=0.1.0

# -----------------------------------------------------------------------------
# Host Configuration
# -----------------------------------------------------------------------------
# Local development: http://localhost:9000 (via docker-compose.sonarqube.yml)
# CI/CD: Uses SonarCloud (https://sonarcloud.io) with SONAR_TOKEN secret
sonar.host.url=http://localhost:9000

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------
# Token is loaded from environment variable SONAR_TOKEN
# NEVER commit tokens to the repository
# Set in .env.local for local development
# Set as GitHub secret for CI/CD

# -----------------------------------------------------------------------------
# Source Code Paths
# -----------------------------------------------------------------------------
# Explicit list of source directories to analyze
sonar.sources=\
  apps/api/src,\
  apps/ai-worker/src,\
  apps/web/src,\
  apps/project-tracker/app,\
  apps/project-tracker/components,\
  apps/project-tracker/lib,\
  packages/adapters/src,\
  packages/api-client/src,\
  packages/application/src,\
  packages/db/src,\
  packages/domain/src,\
  packages/observability/src,\
  packages/platform/src,\
  packages/ui/src,\
  packages/validators/src

# Test directories
sonar.tests=tests

# -----------------------------------------------------------------------------
# File Exclusions
# -----------------------------------------------------------------------------
sonar.exclusions=\
  **/node_modules/**,\
  **/dist/**,\
  **/build/**,\
  **/.next/**,\
  **/coverage/**,\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/migrations/**,\
  **/*.config.js,\
  **/*.config.ts

sonar.test.inclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx

# -----------------------------------------------------------------------------
# Coverage Configuration
# -----------------------------------------------------------------------------
# LCOV report paths for JavaScript/TypeScript coverage
sonar.javascript.lcov.reportPaths=artifacts/coverage/lcov.info,coverage/lcov.info
sonar.typescript.lcov.reportPaths=artifacts/coverage/lcov.info,coverage/lcov.info

# Coverage exclusions (test files, config files, generated code)
sonar.coverage.exclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/*.config.ts,\
  **/*.config.js,\
  **/migrations/**,\
  apps/api/src/tracing/example.ts,\
  apps/project-tracker/app/api/**,\
  apps/project-tracker/components/**,\
  apps/project-tracker/lib/data-sync.ts,\
  apps/web/src/components/**

# -----------------------------------------------------------------------------
# Source Encoding and SCM
# -----------------------------------------------------------------------------
sonar.sourceEncoding=UTF-8
sonar.scm.disabled=false
sonar.scm.provider=git

# -----------------------------------------------------------------------------
# Quality Gate Configuration
# -----------------------------------------------------------------------------
# Quality gate check during analysis (set to true for CI enforcement)
sonar.qualitygate.wait=false

# -----------------------------------------------------------------------------
# Rule Suppressions (Narrow and Explicit)
# -----------------------------------------------------------------------------
# S5256: Table headers - suppressed for UI table component
sonar.issue.ignore.multicriteria=tableHeader
sonar.issue.ignore.multicriteria.tableHeader.ruleKey=typescript:S5256
sonar.issue.ignore.multicriteria.tableHeader.resourceKey=packages/ui/src/components/table.tsx

# =============================================================================
# Quality Gate Targets (IFC-111 KPIs)
# =============================================================================
# Overall Rating: A
# Reliability Rating: A (no new bugs)
# Security Rating: A (no new vulnerabilities)
# Maintainability Rating: A (technical debt ratio < 3%)
# Coverage: >= 80% on new code
# Duplications: < 3% on new code
# Blocker Issues: 0
# Critical Issues: 0
#
# OWASP Top 10 and Clean Code rules are enabled by default in SonarQube
# =============================================================================
