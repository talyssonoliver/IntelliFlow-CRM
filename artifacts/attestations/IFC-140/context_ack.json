{
  "task_id": "IFC-140",
  "task_name": "Implement data governance workflows: DSAR requests; retention & legal hold policies; tenant-specific encryption key management; data residency compliance",
  "sprint": 11,
  "section": "Compliance",
  "owner": "Legal Ops + Security Eng (STOA-Security)",
  "acknowledged_at": "2025-12-29T23:43:00Z",
  "prerequisites_verified": {
    "constitution": {
      "file": ".specify/memory/constitution.md",
      "verified": true,
      "key_requirements": [
        "Domain-Driven Design with hexagonal architecture",
        "Use cases orchestrate domain logic",
        "Domain events for cross-context communication",
        "Security: encryption at rest and in transit"
      ]
    },
    "dependencies": {
      "IFC-098": {
        "status": "DONE",
        "description": "RBAC/ABAC permissions implemented"
      },
      "IFC-127": {
        "status": "DONE",
        "description": "Compliance infrastructure ready"
      }
    },
    "files_read": [
      "docs/planning/adr/ADR-004-multi-tenancy.md",
      "docs/planning/adr/ADR-007-data-governance.md",
      "packages/db/prisma/schema.prisma",
      "infra/supabase/rls-policies.sql"
    ],
    "policies": {
      "data_classification_defined": true,
      "kms_configured": "Will configure per-tenant keys"
    }
  },
  "implementation_approach": {
    "dsar_workflow": {
      "file": "apps/api/src/workflow/dsar-workflow.ts",
      "steps": [
        "Identity verification",
        "Data aggregation across all tables",
        "Export generation (JSON/CSV)",
        "30-day SLA tracking"
      ]
    },
    "retention_enforcement": {
      "mechanism": "Scheduled job (BullMQ worker)",
      "policies": [
        "PUBLIC: 7 years auto-delete",
        "INTERNAL: 3 years auto-delete",
        "CONFIDENTIAL: 10 years manual review",
        "PRIVILEGED: Permanent, no auto-delete"
      ],
      "legal_hold": "Prevents deletion when flag set"
    },
    "encryption_key_management": {
      "file": "artifacts/misc/kms-key-config.json",
      "approach": "Per-tenant encryption keys with rotation schedule"
    },
    "residency_controls": {
      "metadata": "data_residency column in schema",
      "validation": "Ensure data stays in tenant's region"
    },
    "testing_strategy": "Manual review + automated pnpm test"
  },
  "artifacts_to_create": [
    "docs/data-governance/dsar-process.md",
    "docs/data-governance/retention-policy.md",
    "artifacts/misc/kms-key-config.json",
    "apps/api/src/workflow/dsar-workflow.ts",
    "artifacts/misc/compliance-tests/data-governance.spec.ts",
    "artifacts/attestations/IFC-140/context_ack.json"
  ]
}
