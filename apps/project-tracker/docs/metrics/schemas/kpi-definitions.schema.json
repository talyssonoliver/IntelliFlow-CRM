{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "kpi-definitions.schema.json",
  "title": "KPI Definitions Schema",
  "description": "Schema for kpi-definitions.json - standardized KPI measurement definitions",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "last_updated": {
      "type": "string",
      "format": "date-time",
      "pattern": "^(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))T(?:(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?(?:Z))$"
    },
    "description": {
      "type": "string"
    },
    "categories": {
      "type": "object",
      "propertyNames": {
        "type": "string"
      },
      "additionalProperties": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "kpis": {
            "type": "object",
            "propertyNames": {
              "type": "string"
            },
            "additionalProperties": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "description": {
                  "type": "string"
                },
                "unit": {
                  "type": "string",
                  "enum": [
                    "milliseconds",
                    "seconds",
                    "minutes",
                    "percent",
                    "count",
                    "boolean",
                    "dollars"
                  ]
                },
                "targets": {
                  "type": "object",
                  "propertyNames": {
                    "type": "string"
                  },
                  "additionalProperties": {
                    "anyOf": [
                      {
                        "type": "number"
                      },
                      {
                        "type": "boolean"
                      }
                    ]
                  }
                },
                "measurement_method": {
                  "type": "string"
                },
                "validation_command": {
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "null"
                    }
                  ]
                }
              },
              "required": [
                "name",
                "description",
                "unit",
                "targets",
                "measurement_method"
              ],
              "additionalProperties": false
            }
          }
        },
        "required": [
          "name",
          "kpis"
        ],
        "additionalProperties": false
      }
    },
    "measurement_schedule": {
      "type": "object",
      "properties": {
        "continuous": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "per_task": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "per_sprint": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "weekly": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "on_demand": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    }
  },
  "required": [
    "version",
    "last_updated",
    "categories",
    "measurement_schedule"
  ],
  "additionalProperties": false
}
