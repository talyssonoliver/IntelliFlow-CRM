# =============================================================================
# IntelliFlow CRM - SonarQube Project Configuration
# =============================================================================

# Project identification (matches SonarQube server project)
sonar.projectKey=IntelliFlow
sonar.projectName=IntelliFlow CRM
sonar.projectVersion=0.1.0

# Host configuration
sonar.host.url=http://localhost:9000

# Authentication (token loaded from environment or .env.local)
# sonar.token=<your-token-here>

# Source code paths
# Keep this list source-only to avoid scanning runtime/build outputs (e.g. `.next/`).
sonar.sources=\
  apps/api/src,\
  apps/ai-worker/src,\
  apps/web/src,\
  apps/project-tracker/app,\
  apps/project-tracker/components,\
  apps/project-tracker/lib,\
  packages/adapters/src,\
  packages/api-client/src,\
  packages/application/src,\
  packages/db/src,\
  packages/domain/src,\
  packages/observability/src,\
  packages/platform/src,\
  packages/ui/src,\
  packages/validators/src

# Tests are validated separately via CI; keep Sonar's test roots minimal to avoid
# traversing runtime/build output directories under apps/.
sonar.tests=tests

# File inclusions/exclusions
sonar.exclusions=\
  **/node_modules/**,\
  **/dist/**,\
  **/build/**,\
  **/.next/**,\
  **/coverage/**,\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/migrations/**,\
  **/*.config.js,\
  **/*.config.ts

sonar.test.inclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx

# Language-specific settings
# Vitest writes LCOV to artifacts/coverage/lcov.info (see vitest.config.ts).
# Keep coverage/lcov.info as a fallback for older tooling.
sonar.javascript.lcov.reportPaths=artifacts/coverage/lcov.info,coverage/lcov.info
sonar.typescript.lcov.reportPaths=artifacts/coverage/lcov.info,coverage/lcov.info

# Code coverage
sonar.coverage.exclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/*.config.ts,\
  **/*.config.js,\
  **/migrations/**,\
  apps/api/src/tracing/example.ts,\
  apps/project-tracker/app/api/**,\
  apps/project-tracker/components/**,\
  apps/project-tracker/lib/data-sync.ts,\
  apps/web/src/components/**

# Source encoding
sonar.sourceEncoding=UTF-8

# Analysis parameters
sonar.scm.disabled=false
sonar.scm.provider=git

# Quality gate settings
sonar.qualitygate.wait=false

# Sonar rule suppressions (kept narrow and explicit)
sonar.issue.ignore.multicriteria=tableHeader
sonar.issue.ignore.multicriteria.tableHeader.ruleKey=typescript:S5256
sonar.issue.ignore.multicriteria.tableHeader.resourceKey=packages/ui/src/components/table.tsx

# Host URL (uncomment and set when using remote SonarQube server)
# sonar.host.url=http://localhost:9000

# Authentication
# - Recommended: set `SONAR_TOKEN` in your environment or `.env.local` (do not commit tokens).
# - Avoid setting `sonar.login`/`sonar.token` here with placeholders; the scanner does not expand `${env.*}`.
